System.register(["jimu-core","jimu-ui","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/setting-components"],(function(e,t){var a={},o={},s={},i={};return{setters:[function(e){a.ClauseLogic=e.ClauseLogic,a.DataSourceManager=e.DataSourceManager,a.Immutable=e.Immutable,a.JimuFieldType=e.JimuFieldType,a.React=e.React,a.jsx=e.jsx},function(e){o.Button=e.Button},function(e){s.AllDataSourceTypes=e.AllDataSourceTypes,s.DataSourceSelector=e.DataSourceSelector,s.FieldSelector=e.FieldSelector},function(e){i.MapWidgetSelector=e.MapWidgetSelector,i.SettingRow=e.SettingRow,i.SettingSection=e.SettingSection}],execute:function(){e((()=>{var e={891:e=>{"use strict";e.exports=a},726:e=>{"use strict";e.exports=o},338:e=>{"use strict";e.exports=s},756:e=>{"use strict";e.exports=i}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="";var c={};return n.p=window.jimuConfig.baseUrl,(()=>{"use strict";n.r(c),n.d(c,{__set_webpack_public_path__:()=>u,default:()=>r});var e=n(891),t=n(726),a=n(338),o=n(756);const{useState:s,useEffect:i}=e.React,r=n=>{const{id:c,intl:r,config:u,useMapWidgetIds:l,useDataSources:d,useDataSourcesEnabled:g,onSettingChange:m}=n,[p,S]=s([]);i((()=>{var t,a,o,s;return d&&(t=void 0,a=void 0,s=function*(){const t=e.DataSourceManager.getInstance().getDataSource(d[0].dataSourceId);return(yield t.query({outFields:["*"]})).records},new((o=void 0)||(o=Promise))((function(e,i){function n(e){try{r(s.next(e))}catch(e){i(e)}}function c(e){try{r(s.throw(e))}catch(e){i(e)}}function r(t){var a;t.done?e(t.value):(a=t.value,a instanceof o?a:new o((function(e){e(a)}))).then(n,c)}r((s=s.apply(t,a||[])).next())}))).then((e=>{S(e)})),()=>{S([])}}),[d]);const f=(e,t)=>{m({id:c,config:u.set(e,t)})},x=e=>{f("logicOp",e)};return(0,e.jsx)("div",{className:"use-feature-layer-setting p-2"},(0,e.jsx)(o.SettingSection,{className:"map-selector-section",title:r.formatMessage({id:"mapWidgetLabel",defaultMessage:"Select Map widget"})},(0,e.jsx)(o.SettingRow,null,(0,e.jsx)(o.MapWidgetSelector,{onSelect:e=>{n.onSettingChange({id:n.id,useMapWidgetIds:e})},useMapWidgetIds:l}))),(0,e.jsx)(a.DataSourceSelector,{types:(0,e.Immutable)([a.AllDataSourceTypes.FeatureLayer]),useDataSources:d,useDataSourcesEnabled:g,onToggleUseDataEnabled:e=>{m({id:c,useDataSourcesEnabled:e})},onChange:e=>{m({id:c,useDataSources:e})},widgetId:c}),d&&d.length>0&&(0,e.jsx)(o.SettingSection,{className:"map-selector-section"},(0,e.jsx)(o.SettingRow,{flow:"wrap",label:"Logical Operator"},(0,e.jsx)("div",{className:"d-flex w-100 select-mode-con"},(0,e.jsx)("div",{className:"flex-grow-1 text-truncate"},(0,e.jsx)(t.Button,{className:"w-100",active:u.logicOp===e.ClauseLogic.And,onClick:()=>{x(e.ClauseLogic.And)}},e.ClauseLogic.And)),(0,e.jsx)("div",{className:"flex-grow-1 ml-2 text-truncate"},(0,e.jsx)(t.Button,{className:"w-100",active:u.logicOp===e.ClauseLogic.Or,onClick:()=>{x(e.ClauseLogic.Or)}},e.ClauseLogic.Or))))),d&&d.length>0&&(0,e.jsx)(a.FieldSelector,{types:(0,e.Immutable)([e.JimuFieldType.Number]),useDataSources:d,onChange:e=>{m({id:c,useDataSources:[Object.assign(Object.assign({},d[0]),{fields:e.map((e=>e.jimuName))})]});const t=e.map((e=>{const t=p.map((t=>t.getFieldValue(e.jimuName))),a=Math.min(...t),o=0===a?0:Math.floor(Math.log10(Math.abs(a))),s=Math.floor(a/Math.pow(10,o))*Math.pow(10,o),i=Math.max(...t),n=0===i?0:Math.floor(Math.log10(Math.abs(i))),c=Math.ceil(i/Math.pow(10,n))*Math.pow(10,n);return{name:e.jimuName,label:e.alias?e.alias:e.jimuName,min:Number(s.toPrecision(1)),max:Number(c.toPrecision(1))}}));f("fields",t)},selectedFields:d[0].fields||(0,e.Immutable)([]),isMultiple:!0}))};function u(e){n.p=e}})(),c})())}}}));